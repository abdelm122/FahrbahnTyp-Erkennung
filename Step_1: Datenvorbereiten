import os
import pandas as pd

# ===== Pfade =====
INPUT_DIR = r"C:\Users\Oulad\Downloads\Devi"
OUTPUT_DIR = r"C:\Users\Oulad\Downloads\Devi_step1"

# ===== Pflicht-Spalten =====
COLUMNS = [
    "Timestamp(ms)",
    "AX(g)", "AY(g)", "AZ(g)",
    "GX(deg/s)", "GY(deg/s)", "GZ(deg/s)"
]

# Output-Ordner erstellen
if not os.path.exists(OUTPUT_DIR):
    os.makedirs(OUTPUT_DIR)

# ===== Alle Labels =====
for label in os.listdir(INPUT_DIR):

    label_path = os.path.join(INPUT_DIR, label)

    if not os.path.isdir(label_path):
        continue

    new_label_path = os.path.join(OUTPUT_DIR, label)
    if not os.path.exists(new_label_path):
        os.makedirs(new_label_path)

    # ===== Alle CSV-Dateien =====
    for file in os.listdir(label_path):

        if not file.endswith(".csv"):
            continue

        input_file = os.path.join(label_path, file)

        try:
            data = pd.read_csv(input_file)
        except:
            print("Fehler beim Lesen:", input_file)
            continue

        # prüfen ob alle Spalten da sind
        ok = True
        for c in COLUMNS:
            if c not in data.columns:
                ok = False

        if not ok:
            print("Spalten fehlen:", input_file)
            continue

        # nur wichtige Spalten behalten
        data = data[COLUMNS]

        # neue CSV speichern
        output_file = os.path.join(new_label_path, file)
        data.to_csv(output_file, index=False)

        print("Gespeichert:", output_file)

print("✅ STEP 1 abgeschlossen")
